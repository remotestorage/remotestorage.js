

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BaseClient &mdash; remoteStorage.js 1.0.0-alpha7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="remoteStorage.js 1.0.0-alpha7 documentation" href="../index.html"/>
        <link rel="up" title="JavaScript API" href="../js-api.html"/>
        <link rel="prev" title="RemoteStorage" href="remotestorage.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> remoteStorage.js
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0-alpha7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../why.html">Why use this?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-modules.html">Data modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Module API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../caching.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-format.html">Data format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discovery-bootstrap.html">Discovery bootstrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../amd.html">AMD build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodejs.html">Usage with node.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../js-api.html">JavaScript API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="remotestorage.html">RemoteStorage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BaseClient</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-read-write-operations">Data read/write operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#caching-logic-for-read-operations">Caching logic for read operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-of-functions">List of functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other-functions">Other functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">remoteStorage.js</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../js-api.html">JavaScript API</a> &raquo;</li>
        
      <li>BaseClient</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/js-api/base-client.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="baseclient">
<h1>BaseClient<a class="headerlink" href="#baseclient" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-read-write-operations">
<h2>Data read/write operations<a class="headerlink" href="#data-read-write-operations" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal"><span class="pre">BaseClient</span></code> deals with three types of data: folders, objects and files:</p>
<ul class="simple">
<li><a class="reference internal" href="#getListing" title="getListing"><code class="xref js js-func docutils literal"><span class="pre">getListing()</span></code></a> returns a mapping of all items within a folder.</li>
<li><a class="reference internal" href="#getObject" title="getObject"><code class="xref js js-func docutils literal"><span class="pre">getObject()</span></code></a> and <code class="xref js js-func docutils literal"><span class="pre">storeObject()</span></code> operate on JSON objects. Each object
has a type.</li>
<li><a class="reference internal" href="#getFile" title="getFile"><code class="xref js js-func docutils literal"><span class="pre">getFile()</span></code></a> and <code class="xref js js-func docutils literal"><span class="pre">storeFile()</span></code> operates on files. Each file has a MIME
type.</li>
<li><a class="reference internal" href="#getAll" title="getAll"><code class="xref js js-func docutils literal"><span class="pre">getAll()</span></code></a> returns all objects or files for the given folder path.</li>
<li><code class="xref js js-func docutils literal"><span class="pre">remove()</span></code> operates on either objects or files (but not folders; folders
are created and removed implictly).</li>
</ul>
<div class="section" id="caching-logic-for-read-operations">
<span id="max-age"></span><h3>Caching logic for read operations<a class="headerlink" href="#caching-logic-for-read-operations" title="Permalink to this headline">¶</a></h3>
<p>All functions requesting/reading data will immediately return data from the
local store, <em>as long as it is reasonably up-to-date</em>. The default maximum age
of requested data is two times the periodic sync interval (10 seconds by
default).</p>
<p>However, you can adjust this behavior by using the <cite>maxAge</cite> argument with any
of these functions, thereby changing the maximum age or removing the
requirement entirely:</p>
<ul class="simple">
<li>If the <code class="docutils literal"><span class="pre">maxAge</span></code> requirement is set, and the last sync request for the path
is further in the past than the maximum age given, the folder will first be
checked for changes on the remote, and then the promise will be fulfilled
with the up-to-date folder listing.</li>
<li>If the <code class="docutils literal"><span class="pre">maxAge</span></code> requirement cannot be met because of network problems,
the promise will be rejected.</li>
<li>If the <code class="docutils literal"><span class="pre">maxAge</span></code> requirement is set to <code class="docutils literal"><span class="pre">false</span></code>, or the library is in
offline mode (TODO link this), or no remote storage is connected (a.k.a.
“anonymous mode”), the promise will always be fulfilled with data from the
local store.</li>
</ul>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">If caching for the folder is turned off, none of this applies and data will
always be requested from the remote store directly.</p>
</div>
</div>
<div class="section" id="list-of-functions">
<h3>List of functions<a class="headerlink" href="#list-of-functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="getListing">
<code class="descname">getListing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getListing" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of child nodes below a given path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – The path to query. It MUST end with a forward slash.</li>
<li><strong>maxAge</strong> (<em>number</em>) – (optional) Either <code class="docutils literal"><span class="pre">false</span></code> or the maximum age of cached listing in milliseconds. See <a class="reference internal" href="#max-age"><span class="std std-ref">Caching logic for read operations</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A promise for an object representing child nodes</p>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">getListing</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">listing</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">listing</span><span class="p">));</span>
</pre></div>
</div>
<p>The folder listing is returned as a JSON object, with the root keys
representing the pathnames of child nodes. Keys ending in a forward slash
represent <em>folder nodes</em> (subdirectories), while all other keys represent
<em>data nodes</em> (files/objects).</p>
<p>Data node information contains the item’s ETag, content type and -length.</p>
<p>Example of a listing object:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;@context&quot;</span><span class="p">:</span> <span class="s2">&quot;http://remotestorage.io/spec/folder-description&quot;</span><span class="p">,</span>
  <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thumbnails/&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;screenshot-20170902-1913.png&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;ETag&quot;</span><span class="p">:</span> <span class="s2">&quot;6749fcb9eef3f9e46bb537ed020aeece&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Content-Length&quot;</span><span class="p">:</span> <span class="mi">53698</span><span class="p">,</span>
      <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png;charset=binary&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;screenshot-20170823-0142.png&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;ETag&quot;</span><span class="p">:</span> <span class="s2">&quot;92ab84792ef3f9e46bb537edac9bc3a1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Content-Length&quot;</span><span class="p">:</span> <span class="mi">412401</span><span class="p">,</span>
      <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png;charset=binary&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="getObject">
<code class="descname">getObject</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a JSON object from the given path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – Relative path from the module root (without leading slash).</li>
<li><strong>maxAge</strong> (<em>number</em>) – (optional) Either <code class="docutils literal"><span class="pre">false</span></code> or the maximum age of cached object in milliseconds. See <a class="reference internal" href="#max-age"><span class="std std-ref">Caching logic for read operations</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A promise, which resolves with the requested object (or <code class="docutils literal"><span class="pre">null</span></code> if non-existent)</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s1">&#39;/path/to/object&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">obj</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obj</span><span class="p">));</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="getAll">
<code class="descname">getAll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all objects directly below a given path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – Path to the folder. Must end in a forward slash.</li>
<li><strong>maxAge</strong> (<em>number</em>) – (optional) Either <code class="docutils literal"><span class="pre">false</span></code> or the maximum age of cached objects in milliseconds. See <a class="reference internal" href="#max-age"><span class="std std-ref">Caching logic for read operations</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A promise for an object</p>
</td>
</tr>
</tbody>
</table>
<p>Example response object:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">TODO</span>
</pre></div>
</div>
<p>For items that are not JSON-stringified objects (e.g. stored using
<cite>storeFile</cite> instead of <cite>storeObject</cite>), the object’s value is filled in
with <cite>true</cite>.</p>
<p>Example usage:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">getAll</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">objects</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">var</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">objects</span><span class="p">[</span><span class="n">path</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="getFile">
<code class="descname">getFile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the file at the given path. A file is raw data, as opposed to
a JSON object (use <a class="reference internal" href="#getObject" title="getObject"><code class="xref js js-func docutils literal"><span class="pre">getObject()</span></code></a> for that).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – Relative path from the module root (without leading slash).</li>
<li><strong>maxAge</strong> (<em>number</em>) – (optional) Either <code class="docutils literal"><span class="pre">false</span></code> or the maximum age of the cached file in milliseconds. See <a class="reference internal" href="#max-age"><span class="std std-ref">Caching logic for read operations</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A promise for an object</p>
</td>
</tr>
</tbody>
</table>
<p>The response object contains two properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">mimeType</span></code></td>
<td>String representing the MIME Type of the document.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">data</span></code></td>
<td>Raw data of the document (either a string or an ArrayBuffer)</td>
</tr>
</tbody>
</table>
<p>Example usage (displaying an image):</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">getFile</span><span class="p">(</span><span class="s1">&#39;path/to/some/image&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">var</span> <span class="n">blob</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Blob</span><span class="p">([</span><span class="n">file</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="p">{</span> <span class="nb">type</span><span class="p">:</span> <span class="n">file</span><span class="o">.</span><span class="n">mimeType</span> <span class="p">});</span>
  <span class="n">var</span> <span class="n">targetElement</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">findElementById</span><span class="p">(</span><span class="s1">&#39;my-image-element&#39;</span><span class="p">);</span>
  <span class="n">targetElement</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">createObjectURL</span><span class="p">(</span><span class="n">blob</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="other-functions">
<h2>Other functions<a class="headerlink" href="#other-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="scope">
<code class="descname">scope</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a new client, scoped to a subpath of the current client’s
path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>BaseClient</strong> – A new client operating on a subpath of the current base path.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="remotestorage.html" class="btn btn-neutral" title="RemoteStorage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, RS Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0-alpha7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>